(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{557:function(e,t,r){"use strict";r.r(t);r(15),r(12),r(11),r(13),r(32),r(33),r(9),r(51);var n=r(3),o=(r(69),r(40)),d=r(27),c=r(29),l=r(31),f=r(34),m=r(26),h=r(30),v=r(64),y=r(22),C=r(435),O=r(530),j=r(89),M=r(88),R=r(121);function $(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(m.a)(e);if(t){var o=Object(m.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(f.a)(this,r)}}var x=function(e,t,r,desc){var n,o=arguments.length,d=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(d=(o<3?n(d):o>3?n(t,r,d):n(t,r))||d);return o>3&&d&&Object.defineProperty(t,r,d),d},I=Object(v.namespace)(j.name),_=function(e){Object(l.a)(n,e);var t,r=w(n);function n(){var e;return Object(d.a)(this,n),(e=r.apply(this,arguments)).numberIsValid=null,e.mobile={countryCode:"GB",cardholderMobileNumber:""},e}return Object(c.a)(n,[{key:"doAdd",value:function(e){var t=this;e.preventDefault(),this.isConsumer&&(this.numberIsValid=!0),null===this.numberIsValid&&(this.numberIsValid=!1),this.$v.updateManagedCardRequest&&(this.$v.updateManagedCardRequest.$touch(),this.$v.updateManagedCardRequest.$anyError||!this.numberIsValid)||this.stores.cards.update(this.updateManagedCardRequest).then((function(){try{t.$segment.track("Card Updated",t.updateManagedCardRequest)}catch(e){}t.$router.push("/managed-cards")}))}},{key:"asyncData",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,o,d,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.store,n=t.route,o=n.params.id,e.next=4,Object(R.b)(r).getManagedCard(o);case 4:return d=e.sent,c=Object(O.a)(d.data.cardholderMobileNumber),l={id:o,body:N({},d.data)},e.abrupt("return",{cardId:o,updateManagedCardRequest:l,mobile:{countryCode:null==c?void 0:c.country,cardholderMobileNumber:null==c?void 0:c.nationalNumber}});case 8:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"phoneUpdate",value:function(e){this.$set(this.mobile,"cardholderMobileNumber",e.formatNational?e.formatNational:e.phoneNumber),this.updateManagedCardRequest.body.cardholderMobileNumber=e.formattedNumber,this.numberIsValid=e.isValid}},{key:"isLoading",get:function(){return this.stores.cards.isLoading}}]),n}(Object(y.mixins)(M.a));x([I.Getter],_.prototype,"auth",void 0),x([I.Getter],_.prototype,"isConsumer",void 0);var k=_=x([Object(y.Component)({components:{ErrorAlert:function(){return r.e(1).then(r.bind(null,467))},LoaderButton:function(){return r.e(0).then(r.bind(null,466))}},validations:{updateManagedCardRequest:{body:{friendlyName:{required:C.required,maxLength:Object(C.maxLength)(50)},cardholderMobileNumber:{requiredIf:Object(C.requiredIf)((function(){return!this.isConsumer})),cardholderMobileNumber:C.helpers.regex("cardholderMobileNumber",/^\+[0-9]+$/)},nameOnCard:{requiredIf:Object(C.requiredIf)((function(){return!this.isConsumer})),maxLength:Object(C.maxLength)(30)}}}}})],_),D=r(42),component=Object(D.a)(k,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("b-container",[r("b-row",[r("b-col",{attrs:{md:"6","offset-md":"3"}},[r("b-card",{staticClass:"border-0"},[r("b-card-title",{staticClass:"mb-5 text-center font-weight-lighter"},[e._v("\n            Update Card\n          ")]),e._v(" "),r("b-card-body",[r("b-form",{on:{submit:e.doAdd}},[e.isConsumer?e._e():r("b-form-row",[r("b-col",[r("b-form-group",{attrs:{label:"Name of Person using Card"}},[r("b-form-input",{attrs:{state:e.isInvalid(e.$v.updateManagedCardRequest.body.nameOnCard),placeholder:"eg. Elon Musk",disabled:""},model:{value:e.$v.updateManagedCardRequest.body.nameOnCard.$model,callback:function(t){e.$set(e.$v.updateManagedCardRequest.body.nameOnCard,"$model",t)},expression:"$v.updateManagedCardRequest.body.nameOnCard.$model"}}),e._v(" "),r("b-form-invalid-feedback",[e._v("This field is required.")])],1)],1)],1),e._v(" "),e.isConsumer?e._e():r("b-form-row",[r("b-col",[r("b-form-group",{attrs:{label:"CARDHOLDER MOBILE NUMBER"}},[r("vue-phone-number-input",{attrs:{value:e.mobile.cardholderMobileNumber,error:!1===e.numberIsValid,"border-radius":0,defaultCountryCode:e.mobile.countryCode,color:"#6C1C5C","error-color":"#F50E4C","valid-color":"#6D7490"},on:{update:e.phoneUpdate}}),e._v(" "),!1===e.numberIsValid?r("b-form-invalid-feedback",{attrs:{"force-show":""}},[e._v("\n                      This field must be a valid mobile number.\n                    ")]):e._e()],1)],1)],1),e._v(" "),r("b-form-row",[r("b-col",[r("b-form-group",{attrs:{label:"CUSTOM CARD NAME"}},[r("b-form-input",{attrs:{state:e.isInvalid(e.$v.updateManagedCardRequest.body.friendlyName),placeholder:"eg. travel expenses"},model:{value:e.$v.updateManagedCardRequest.body.friendlyName.$model,callback:function(t){e.$set(e.$v.updateManagedCardRequest.body.friendlyName,"$model",t)},expression:"$v.updateManagedCardRequest.body.friendlyName.$model"}}),e._v(" "),r("b-form-invalid-feedback",[e._v("This field is required.")])],1)],1)],1),e._v(" "),r("loader-button",{staticClass:"mt-5 text-center",attrs:{"is-loading":e.isLoading,"button-text":"next"}})],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);