(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{538:function(e,t,n){"use strict";n.r(t);n(32),n(33),n(9),n(51),n(69);var o=n(40),r=n(27),c=n(29),l=n(31),d=n(34),f=n(26),h=n(30),v=n(64),m=n(22),y=n(89),w=n(90),k=n(67),x=n(88);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(d.a)(this,n)}}var C=function(e,t,n,desc){var o,r=arguments.length,c=r<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(c=(r<3?o(c):r>3?o(t,n,c):o(t,n))||c);return r>3&&c&&Object.defineProperty(t,n,c),c},O=Object(v.namespace)(y.name),_=function(e){Object(l.a)(f,e);var t,n,d=R(f);function f(){var e;return Object(r.a)(this,f),(e=d.apply(this,arguments)).loginRequest={code:"",password:""},e}return Object(c.a)(f,[{key:"isLoggedInChanged",value:function(e){console.warn(e)}},{key:"login",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Login Function");try{k.Helpers.tokenize(this.$store).then((function(e){console.log("Password tokenisation success"),t.loginRequest.password=e.password,t.authenticate(t.loginRequest).then(t.goToDashboard.bind(t))}),(function(e){console.log("tokenisation failed",e)}))}catch(e){console.log("Login error:",e)}case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"goToDashboard",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("auth success"),n=t.data.credential.type+"-"+t.data.credential.id;try{this.$segment.identify(n,{email:this.loginRequest.code})}catch(e){}if(!y.Helpers.isConsumer(this.$store)){e.next=6;break}return e.next=6,w.Helpers.get(this.$store,y.Helpers.identity(this.$store).id);case 6:this.$router.push("/");case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"checkOnKeyUp",value:function(e){"Enter"===e.key&&(e.preventDefault(),console.log("Submit form throught password enter"),this.login())}},{key:"asyncData",value:function(e){var t=e.store,n=e.redirect;t.getters["auth/isLoggedIn"]&&n("/")}},{key:"receiveMessage",value:function(e){console.log("MESSAGE",e.data)}},{key:"beforeMount",value:function(){window.addEventListener("message",this.receiveMessage,!1)}},{key:"beforeDestroy",value:function(){window.removeEventListener("message",this.receiveMessage,!1)}},{key:"passwordBaseStyle",get:function(){return{color:"#495057",fontSize:"16px",fontSmoothing:"antialiased",fontFamily:"'Be Vietnam', sans-serif",fontWeight:"400",lineHeight:"24px",margin:"0",padding:"6px 12px",textIndent:"0px","::placeholder":{color:"#B6B9C7",fontWeight:"400"}}}}]),f}(Object(m.mixins)(x.a));C([O.Getter],_.prototype,"isLoggedIn",void 0),C([O.Action],_.prototype,"authenticate",void 0),C([O.Getter],_.prototype,"isLoading",void 0),C([Object(m.Watch)("isLoggedIn")],_.prototype,"isLoggedInChanged",null);var j=_=C([Object(m.Component)({layout:"auth",components:{ErrorAlert:function(){return n.e(1).then(n.bind(null,467))},LoaderButton:function(){return n.e(0).then(n.bind(null,466))}}})],_),L=n(42),component=Object(L.a)(j,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-col",{attrs:{lg:"6","offset-lg":"3"}},[n("div",{staticClass:"text-center pb-5"},[n("img",{staticClass:"d-inline-block align-top",attrs:{src:"/img/logo.svg",width:"200",alt:"onvirtual.cards"}})]),e._v(" "),n("b-card",{attrs:{"body-class":"p-card"}},[n("h3",{staticClass:"text-center font-weight-light mb-5"},[e._v("\n      Login\n    ")]),e._v(" "),n("form",{staticClass:"mt-5",attrs:{id:"contact-form"},on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[n("error-alert",{attrs:{message:"Incorrect email and password combination. If you do not have an account please click on Register."}}),e._v(" "),n("b-form-group",{attrs:{id:"ig-code",label:"EMAIL","label-for":"form-code"}},[n("b-form-input",{staticClass:"form-control",attrs:{id:"from-code",name:"setCode",placeholder:"Email"},model:{value:e.loginRequest.code,callback:function(t){e.$set(e.loginRequest,"code",t)},expression:"loginRequest.code"}})],1),e._v(" "),n("client-only",{attrs:{placeholder:"Loading..."}},[n("weavr-form",{ref:"passwordForm"},[n("label",{staticClass:"d-block"},[e._v("PASSWORD")]),e._v(" "),n("weavr-input",{attrs:{options:{placeholder:"Password"},"base-style":e.passwordBaseStyle,"class-name":"sign-in-password",name:"password",field:"password"},on:{onKeyUp:e.checkOnKeyUp}})],1)],1),e._v(" "),n("div",{staticClass:"mt-2"},[n("b-link",{staticClass:"small text-decoration-underline text-grey",attrs:{to:"/password/reset"}},[e._v("\n          Forgot password?\n        ")])],1),e._v(" "),n("b-form-group",{staticClass:"mt-5 text-center"},[n("b-overlay",{staticClass:"d-inline-block",attrs:{show:e.isLoading,rounded:"pill","spinner-small":""}},[n("b-button",{attrs:{type:"submit",variant:"secondary"}},[e._v("\n            sign in\n            "),n("span",{staticClass:"pl-5"},[e._v("->")])])],1)],1),e._v(" "),n("div",{staticClass:"mt-4 text-center"},[n("small",{staticClass:"text-grey"},[e._v("\n          Not yet registered? Register\n          "),n("b-link",{staticClass:"text-decoration-underline text-grey",attrs:{to:"/register"}},[e._v("here")]),e._v("\n          .\n        ")],1)])],1)])],1)}),[],!1,null,null,null);t.default=component.exports}}]);